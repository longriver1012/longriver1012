var d=Object.defineProperty;var P=(a,e,t)=>e in a?d(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var r=(a,e,t)=>P(a,typeof e!="symbol"?e+"":e,t);import{aD as E,r as i,ax as C}from"./index-__Usss8N.js";import{g as l}from"./project-tpiy63pn.js";import{P as S,V as m,E as p,m as w,am as y,aM as R,aN as v,aO as T,Q as x,c as V,aP as c,aL as b}from"./useSize-CrGhzOM0.js";class z extends S{constructor(t){super(t);r(this,"camera");r(this,"cameraPosition");r(this,"cameraRotation");r(this,"cameraTarget");r(this,"cameraComponent");this.cameraPosition=new m,this.cameraRotation=new p,this.cameraTarget=new m}start(){this.camera=this.core.runtimeManager.camera,this.camera&&(this.cameraPosition.copy(this.camera.position),this.cameraRotation.copy(this.camera.rotation),this.cameraComponent=this.camera.getComponent(w.OrbitControls),this.cameraComponent&&this.cameraTarget.copy(this.cameraComponent.controls.target))}reset(){var t,n;this.camera&&(this.camera.position.copy(this.cameraPosition),this.camera.rotation.copy(this.cameraRotation),(t=this.cameraComponent)==null||t.controls.target.copy(this.cameraTarget),(n=this.cameraComponent)==null||n.controls.update(),this.core.runtimeManager.setCamera(this.camera))}}class j{constructor(){r(this,"core");r(this,"resetPlugin");r(this,"onReloadScene",async e=>{const{code:t}=e;this.core.clear(),await l(t),this.open(t)});this.core=new y({}),this.resetPlugin=new z(this.core),this.core.use(this.resetPlugin),this.core.bus.on("RELOAD_SCENE",this.onReloadScene)}mount(e){this.core.mount(e)}active(){this.core.active()}deactive(){this.core.deactive()}unmount(){this.core.bus.off("RELOAD_SCENE",this.onReloadScene),this.core.unmount()}resize(){this.core.resize()}static registerSymbol(e){R.registerSymbol(e)}reset(){this.resetPlugin.reset()}open(e){this.core.deserialize(e),this.core.runtimeManager.start(),this.resetPlugin.start()}}const M=()=>{window.VE={animation:{to:c.to,from:c.from,fromTo:c.fromTo,timeline:c.timeline},math:{Vector3:m,Vector2:V,Quaternion:x,Euler:p},scene:{flyTo:T,roam:v}}},_="_container_1gd90_1",D={container:_};M();const A=()=>{const[a]=E(),e=i.useRef(null),t=b(e),[n,f]=i.useState(""),[s,h]=i.useState();i.useEffect(()=>{const o=a.get("id");o&&f(o)},[a]),i.useEffect(()=>{const o=new j;return o.mount(e.current),o.active(),h(o),()=>{o.deactive(),o.unmount(),h(void 0)}},[]),i.useEffect(()=>{s==null||s.resize()},[s,t]);const g=async o=>{const u=await l(o);window.document.title=u.name,s==null||s.open(u.content)};return i.useEffect(()=>{n&&s&&g(n)},[n,s]),C.jsx("div",{className:D.container,ref:e})};export{A as default};
