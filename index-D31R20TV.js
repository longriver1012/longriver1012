import{d as m,I as A,n as E,al as e,aE as F,aF as G,aG as H,aH as k,aI as O,am as P,an as I,aJ as T,aK as M,aL as R,aA as g,aM as L,aN as V,aO as q,aP as J,aQ as K,aR as Q}from"./index-ClVA2v0D.js";import{F as b,M as U,I as N,S as W}from"./index-0JeOY9gX.js";var X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"},Z=function(t,a){return m.createElement(A,E({},t,{ref:a,icon:X}))},ee=m.forwardRef(Z);const te="_container_n78rt_1",se="_right_n78rt_8",w={container:te,right:se},ne="_container_1ag6p_1",oe="_logo_1ag6p_5",ce="_item_1ag6p_9",ae="_label_1ag6p_22",p={container:ne,logo:oe,item:ce,label:ae},ie=n=>{const{onClick:t}=n;return e.jsxs("div",{className:p.container,children:[e.jsx("div",{className:p.logo,children:e.jsx("img",{src:F,style:{width:"70%",marginTop:"-5px"}})}),e.jsxs("div",{className:p.item,onClick:()=>t("projects"),children:[e.jsx("span",{className:"iconfont icon-project"}),e.jsx("span",{className:p.label,children:"项目"})]}),e.jsxs("div",{className:p.item,onClick:()=>t("templates"),children:[e.jsx("span",{className:"iconfont icon-template"}),e.jsx("span",{className:p.label,children:"示例"})]}),e.jsxs("div",{className:p.item,onClick:()=>t("documents"),children:[e.jsx("span",{className:"iconfont icon-doc"}),e.jsx("span",{className:p.label,children:"文档"})]})]})},le="_title-container_121nn_1",re="_title_121nn_1",de="_container_121nn_12",me="_body_121nn_18",pe="_projects_121nn_38",_={titleContainer:le,title:re,container:de,body:me,projects:pe},je=G()(H(n=>({setService:t=>{k.set("service",t),n({service:t})},service:k.get("service")||"local"}))),xe={labelCol:{xs:{span:8},sm:{span:4}},wrapperCol:{xs:{span:16},sm:{span:20}}},ve=n=>{const{visible:t,setVisible:a,onConfirm:i}=n,[r]=b.useForm(),[o,d]=m.useState(!1),j=()=>{r.submit()},c=()=>{a(!1)},x=async v=>{d(!0);const{name:f,desc:$}=v,u=await O(f,$);u===-1?P.error("项目名称已存在，请更换名称"):(a(!1),i(u)),d(!1)};return e.jsx(U,{title:"创建3D项目",open:t,loading:o,onOk:j,onCancel:c,children:e.jsxs(b,{form:r,...xe,onFinish:x,children:[e.jsx(b.Item,{label:"项目名称",name:"name",rules:[{required:!0,message:"请输入项目名称"}],children:e.jsx(N,{})}),e.jsx(b.Item,{label:"项目描述",name:"desc",children:e.jsx(N.TextArea,{})})]})})},_e="_project_16x4a_1",he="_cover_16x4a_18",ue="_actived_16x4a_28",ge="_name_16x4a_32",y={project:_e,cover:he,actived:ue,name:ge},be=[{label:"复制",key:"copy"},{label:"导出",key:"export"},{label:"删除",key:"delete"}],ye=n=>{const{item:t,actived:a,onClick:i,onDoubleClick:r,onDelete:o,onCopy:d}=n,j=async({key:c})=>{if(c==="delete")o();else if(c==="export"){const x=await T(t.code),v=M().format("YYYY-MM-DD HH-mm-ss");R(x,`projects-${v}.zip`)}else c==="copy"&&d(t.code)};return e.jsx(I,{menu:{items:be,onClick:j},trigger:["contextMenu"],children:e.jsxs("div",{className:y.project,onClick:i,onContextMenu:i,onDoubleClick:r,children:[e.jsx("div",{className:`${y.cover} ${a===t.code?y.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:y.name,children:t.name})]})})},Ce=[{label:"本地服务",value:"local"},{label:"远端服务",value:"remote"}],fe=()=>{const[n,t]=m.useState([]),[a,i]=m.useState(!1),[r,o]=m.useState(""),{service:d,setService:j}=je(),c=async()=>{const s=await L();t(s)};m.useEffect(()=>{c()},[]);const x=s=>{window.open(`#/editor?id=${s.code}`,`#/editor?id=${s.code}`)},v=async s=>{await K(s.code),await c()},f=()=>{i(!0)},$=s=>{c(),window.open(`#/editor?id=${s}`,`#/editor?id=${s}`)},u=s=>{j(s),c()},S=async()=>{await V(),await c()},z=async()=>{const s=await q(n.map(Y=>Y.code)),B=M().format("YYYY-MM-DD HH-mm-ss");R(s,`projects-${B}.zip`)},D=async s=>{await J(s),await c()};return e.jsxs("div",{className:_.container,children:[e.jsxs("div",{className:_.titleContainer,children:[e.jsx("div",{className:_.title,children:"项目"}),e.jsxs("div",{children:[e.jsx(g,{type:"link",icon:e.jsx(ee,{style:{fontSize:20,marginRight:8,color:"#fff",verticalAlign:"-0.25rem"}}),onClick:()=>window.open("https://github.com/longriver1012/visual-engine","_blank")}),e.jsx(W,{options:Ce,style:{width:"100px",marginRight:8},value:d,onChange:u}),e.jsx(g,{style:{marginRight:8},onClick:S,children:"导入项目"}),e.jsx(g,{style:{marginRight:8},onClick:z,children:"导出项目"}),e.jsx(g,{type:"primary",style:{marginRight:8},onClick:f,children:"新建项目"})]})]}),e.jsx("div",{className:_.body,children:e.jsx("div",{className:_.projects,children:n.map(s=>e.jsx(ye,{item:s,actived:r,onClick:()=>o(s.code),onDoubleClick:()=>x(s),onDelete:()=>v(s),onCopy:D},s.code))})}),e.jsx(ve,{visible:a,setVisible:i,onConfirm:$})]})},$e="_title-container_121nn_1",ke="_title_121nn_1",Ne="_container_121nn_12",we="_body_121nn_18",Pe="_projects_121nn_38",h={titleContainer:$e,title:ke,container:Ne,body:we,projects:Pe},Ie="_project_16x4a_1",Me="_cover_16x4a_18",Re="_actived_16x4a_28",Se="_name_16x4a_32",C={project:Ie,cover:Me,actived:Re,name:Se},ze=[{label:"导入",key:"import"}],De=n=>{const{item:t,actived:a,onClick:i,onImport:r}=n,o=async({key:d})=>{d==="import"&&r()};return e.jsx(I,{menu:{items:ze,onClick:o},trigger:["contextMenu"],children:e.jsxs("div",{className:C.project,onClick:i,onContextMenu:i,children:[e.jsx("div",{className:`${C.cover} ${a===t.name?C.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:C.name,children:t.name})]})})},l=window.location.hostname==="localhost"?"":"/longriver1012",Be=[{name:"基础测试",cover:l+"/templates/基础测试.png",content:l+"/templates/基础测试.zip"},{name:"PBR各部分实现",cover:l+"/templates/PBR各部分实现.png",content:l+"/templates/PBR各部分实现.zip"},{name:"PBR环境光照实现",cover:l+"/templates/PBR环境光照实现.png",content:l+"/templates/PBR环境光照实现.zip"},{name:"地球",cover:l+"/templates/地球.png",content:l+"/templates/地球.zip"},{name:"材质展示",cover:l+"/templates/材质展示.png",content:l+"/templates/材质展示.zip"},{name:"物理材质",cover:l+"/templates/物理材质.png",content:l+"/templates/物理材质.zip"}],Ye=n=>{const{onImport:t}=n,[a,i]=m.useState(""),r=async o=>{const j=await(await fetch(o.content)).blob(),c=new File([j],`${o.name}.zip`,{type:"application/zip"});await Q(c),t(),P.success(`已导入模板：${o.name}`)};return e.jsxs("div",{className:h.container,children:[e.jsx("div",{className:h.titleContainer,children:e.jsx("div",{className:h.title,children:"模板"})}),e.jsx("div",{className:h.body,children:e.jsx("div",{className:h.projects,children:Be.map(o=>e.jsx(De,{item:o,actived:a,onClick:()=>i(o.name),onImport:()=>r(o)},o.name))})})]})},Fe=()=>{const[n,t]=m.useState("projects");return e.jsxs("div",{className:w.container,children:[e.jsx(ie,{onClick:t}),e.jsxs("div",{className:w.right,children:[n==="projects"&&e.jsx(fe,{}),n==="templates"&&e.jsx(Ye,{onImport:()=>t("projects")})]})]})};export{Fe as default};
