import{d as p,I as Y,n as T,ao as e,aJ as O,aK as A,ap as N,aq as P,aL as E,aM as I,aN as M,aD as g,aO as F,aP as G,aQ as H,aR as L,aS as q,aT as V}from"./index-ChS11d-7.js";import{F as b,M as J,I as w,s as K,S as Q}from"./service-BmNhO7pL.js";var U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"},W=function(t,a){return p.createElement(Y,T({},t,{ref:a,icon:U}))},X=p.forwardRef(W);const Z="_container_n78rt_1",ee="_right_n78rt_8",k={container:Z,right:ee},te="_container_1ag6p_1",ne="_logo_1ag6p_5",se="_item_1ag6p_9",oe="_label_1ag6p_22",j={container:te,logo:ne,item:se,label:oe},ce=s=>{const{onClick:t}=s;return e.jsxs("div",{className:j.container,children:[e.jsx("div",{className:j.logo,children:e.jsx("img",{src:O,style:{width:"70%",marginTop:"-5px"}})}),e.jsxs("div",{className:j.item,onClick:()=>t("projects"),children:[e.jsx("span",{className:"iconfont icon-project"}),e.jsx("span",{className:j.label,children:"项目"})]}),e.jsxs("div",{className:j.item,onClick:()=>t("templates"),children:[e.jsx("span",{className:"iconfont icon-template"}),e.jsx("span",{className:j.label,children:"示例"})]}),e.jsxs("div",{className:j.item,onClick:()=>t("documents"),children:[e.jsx("span",{className:"iconfont icon-doc"}),e.jsx("span",{className:j.label,children:"文档"})]})]})},ae="_title-container_121nn_1",ie="_title_121nn_1",le="_container_121nn_12",re="_body_121nn_18",de="_projects_121nn_38",_={titleContainer:ae,title:ie,container:le,body:re,projects:de},me={labelCol:{xs:{span:8},sm:{span:4}},wrapperCol:{xs:{span:16},sm:{span:20}}},pe=s=>{const{visible:t,setVisible:a,onConfirm:i}=s,[r]=b.useForm(),[o,d]=p.useState(!1),x=()=>{r.submit()},c=()=>{a(!1)},m=async v=>{d(!0);const{name:f,desc:$}=v,u=await A(f,$);u===-1?N.error("项目名称已存在，请更换名称"):(a(!1),i(u)),d(!1)};return e.jsx(J,{title:"创建3D项目",open:t,loading:o,onOk:x,onCancel:c,children:e.jsxs(b,{form:r,...me,onFinish:m,children:[e.jsx(b.Item,{label:"项目名称",name:"name",rules:[{required:!0,message:"请输入项目名称"}],children:e.jsx(w,{})}),e.jsx(b.Item,{label:"项目描述",name:"desc",children:e.jsx(w.TextArea,{})})]})})},je="_project_16x4a_1",xe="_cover_16x4a_18",ve="_actived_16x4a_28",_e="_name_16x4a_32",y={project:je,cover:xe,actived:ve,name:_e},he=[{label:"预览",key:"preview"},{label:"复制",key:"copy"},{label:"导出",key:"export"},{label:"删除",key:"delete"}],ue=s=>{const{item:t,actived:a,onClick:i,onDoubleClick:r,onDelete:o,onCopy:d}=s,x=async({key:c})=>{if(c==="delete")o();else if(c==="export"){const m=await E(t.code),v=I().format("YYYY-MM-DD HH-mm-ss");M(m,`projects-${v}.zip`)}else if(c==="copy")d(t.code);else if(c==="preview"){const m=window.open(`#/preview?id=${t.code}`,`#/preview?id=${t.code}`);m==null||m.location.reload()}};return e.jsx(P,{menu:{items:he,onClick:x},trigger:["contextMenu"],children:e.jsxs("div",{className:y.project,onClick:i,onContextMenu:i,onDoubleClick:r,children:[e.jsx("div",{className:`${y.cover} ${a===t.code?y.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:y.name,children:t.name})]})})},ge=[{label:"本地服务",value:"local"},{label:"远端服务",value:"remote"}],be=()=>{const[s,t]=p.useState([]),[a,i]=p.useState(!1),[r,o]=p.useState(""),{service:d,setService:x}=K(),c=async()=>{const n=await F();t(n)};p.useEffect(()=>{c()},[]);const m=n=>{window.open(`#/editor?id=${n.code}`,`#/editor?id=${n.code}`)},v=async n=>{await q(n.code),await c()},f=()=>{i(!0)},$=n=>{c(),window.open(`#/editor?id=${n}`,`#/editor?id=${n}`)},u=n=>{x(n),c()},R=async()=>{await G(),await c()},S=async()=>{const n=await H(s.map(B=>B.code)),D=I().format("YYYY-MM-DD HH-mm-ss");M(n,`projects-${D}.zip`)},z=async n=>{await L(n),await c()};return e.jsxs("div",{className:_.container,children:[e.jsxs("div",{className:_.titleContainer,children:[e.jsx("div",{className:_.title,children:"项目"}),e.jsxs("div",{children:[e.jsx(g,{type:"link",icon:e.jsx(X,{style:{fontSize:20,marginRight:8,color:"#fff",verticalAlign:"-0.25rem"}}),onClick:()=>window.open("https://github.com/longriver1012/visual-engine","_blank")}),e.jsx(Q,{options:ge,style:{width:"100px",marginRight:8},value:d,onChange:u}),e.jsx(g,{style:{marginRight:8},onClick:R,children:"导入项目"}),e.jsx(g,{style:{marginRight:8},onClick:S,children:"导出项目"}),e.jsx(g,{type:"primary",style:{marginRight:8},onClick:f,children:"新建项目"})]})]}),e.jsx("div",{className:_.body,children:e.jsx("div",{className:_.projects,children:s.map(n=>e.jsx(ue,{item:n,actived:r,onClick:()=>o(n.code),onDoubleClick:()=>m(n),onDelete:()=>v(n),onCopy:z},n.code))})}),e.jsx(pe,{visible:a,setVisible:i,onConfirm:$})]})},ye="_title-container_121nn_1",Ce="_title_121nn_1",fe="_container_121nn_12",$e="_body_121nn_18",we="_projects_121nn_38",h={titleContainer:ye,title:Ce,container:fe,body:$e,projects:we},ke="_project_16x4a_1",Ne="_cover_16x4a_18",Pe="_actived_16x4a_28",Ie="_name_16x4a_32",C={project:ke,cover:Ne,actived:Pe,name:Ie},Me=[{label:"导入",key:"import"}],Re=s=>{const{item:t,actived:a,onClick:i,onImport:r}=s,o=async({key:d})=>{d==="import"&&r()};return e.jsx(P,{menu:{items:Me,onClick:o},trigger:["contextMenu"],children:e.jsxs("div",{className:C.project,onClick:i,onContextMenu:i,children:[e.jsx("div",{className:`${C.cover} ${a===t.name?C.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:C.name,children:t.name})]})})},l=window.location.hostname==="localhost"?"":"/longriver1012",Se=[{name:"基础测试",cover:l+"/templates/基础测试.png",content:l+"/templates/基础测试.zip"},{name:"PBR各部分实现",cover:l+"/templates/PBR各部分实现.png",content:l+"/templates/PBR各部分实现.zip"},{name:"PBR环境光照实现",cover:l+"/templates/PBR环境光照实现.png",content:l+"/templates/PBR环境光照实现.zip"},{name:"地球",cover:l+"/templates/地球.png",content:l+"/templates/地球.zip"},{name:"材质展示",cover:l+"/templates/材质展示.png",content:l+"/templates/材质展示.zip"},{name:"物理材质",cover:l+"/templates/物理材质.png",content:l+"/templates/物理材质.zip"}],ze=s=>{const{onImport:t}=s,[a,i]=p.useState(""),r=async o=>{const x=await(await fetch(o.content)).blob(),c=new File([x],`${o.name}.zip`,{type:"application/zip"});await V(c),t(),N.success(`已导入模板：${o.name}`)};return e.jsxs("div",{className:h.container,children:[e.jsx("div",{className:h.titleContainer,children:e.jsx("div",{className:h.title,children:"模板"})}),e.jsx("div",{className:h.body,children:e.jsx("div",{className:h.projects,children:Se.map(o=>e.jsx(Re,{item:o,actived:a,onClick:()=>i(o.name),onImport:()=>r(o)},o.name))})})]})},Ye=()=>{const[s,t]=p.useState("projects");return e.jsxs("div",{className:k.container,children:[e.jsx(ce,{onClick:t}),e.jsxs("div",{className:k.right,children:[s==="projects"&&e.jsx(be,{}),s==="templates"&&e.jsx(ze,{onImport:()=>t("projects")})]})]})};export{Ye as default};
