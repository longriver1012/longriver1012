import{d,I as Y,n as A,al as e,aE as E,aF as F,aG as G,aH as $,aI as H,am as w,an as P,aJ as O,aK as I,aL as M,aA as h,aM as T,aN as L,aO as V,aP as q,aQ as J,aR as K}from"./index-Bp_AL9ij.js";import{F as u,M as Q,I as k,S as U}from"./index-C-Dp5pRT.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"},X=function(t,a){return d.createElement(Y,A({},t,{ref:a,icon:W}))},Z=d.forwardRef(X);const ee="_container_n78rt_1",te="_right_n78rt_8",N={container:ee,right:te},ne="_container_1ag6p_1",se="_logo_1ag6p_5",oe="_item_1ag6p_9",ce="_label_1ag6p_22",m={container:ne,logo:se,item:oe,label:ce},ae=s=>{const{onClick:t}=s;return e.jsxs("div",{className:m.container,children:[e.jsx("div",{className:m.logo,children:e.jsx("img",{src:E,style:{width:"70%",marginTop:"-5px"}})}),e.jsxs("div",{className:m.item,onClick:()=>t("projects"),children:[e.jsx("span",{className:"iconfont icon-project"}),e.jsx("span",{className:m.label,children:"项目"})]}),e.jsxs("div",{className:m.item,onClick:()=>t("templates"),children:[e.jsx("span",{className:"iconfont icon-template"}),e.jsx("span",{className:m.label,children:"示例"})]}),e.jsxs("div",{className:m.item,onClick:()=>t("documents"),children:[e.jsx("span",{className:"iconfont icon-doc"}),e.jsx("span",{className:m.label,children:"文档"})]})]})},ie="_title-container_121nn_1",re="_title_121nn_1",le="_container_121nn_12",de="_body_121nn_18",me="_projects_121nn_38",x={titleContainer:ie,title:re,container:le,body:de,projects:me},pe=F()(G(s=>({setService:t=>{$.set("service",t),s({service:t})},service:$.get("service")||"local"}))),je={labelCol:{xs:{span:8},sm:{span:4}},wrapperCol:{xs:{span:16},sm:{span:20}}},ve=s=>{const{visible:t,setVisible:a,onConfirm:i}=s,[r]=u.useForm(),[o,l]=d.useState(!1),p=()=>{r.submit()},c=()=>{a(!1)},j=async v=>{l(!0);const{name:C,desc:f}=v,g=await H(C,f);g===-1?w.error("项目名称已存在，请更换名称"):(a(!1),i(g)),l(!1)};return e.jsx(Q,{title:"创建3D项目",open:t,loading:o,onOk:p,onCancel:c,children:e.jsxs(u,{form:r,...je,onFinish:j,children:[e.jsx(u.Item,{label:"项目名称",name:"name",rules:[{required:!0,message:"请输入项目名称"}],children:e.jsx(k,{})}),e.jsx(u.Item,{label:"项目描述",name:"desc",children:e.jsx(k.TextArea,{})})]})})},xe="_project_16x4a_1",_e="_cover_16x4a_18",ge="_actived_16x4a_28",he="_name_16x4a_32",b={project:xe,cover:_e,actived:ge,name:he},ue=[{label:"复制",key:"copy"},{label:"导出",key:"export"},{label:"删除",key:"delete"}],be=s=>{const{item:t,actived:a,onClick:i,onDoubleClick:r,onDelete:o,onCopy:l}=s,p=async({key:c})=>{if(c==="delete")o();else if(c==="export"){const j=await O(t.code),v=I().format("YYYY-MM-DD HH-mm-ss");M(j,`projects-${v}.zip`)}else c==="copy"&&l(t.code)};return e.jsx(P,{menu:{items:ue,onClick:p},trigger:["contextMenu"],children:e.jsxs("div",{className:b.project,onClick:i,onContextMenu:i,onDoubleClick:r,children:[e.jsx("div",{className:`${b.cover} ${a===t.code?b.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:b.name,children:t.name})]})})},ye=[{label:"本地服务",value:"local"},{label:"远端服务",value:"remote"}],Ce=()=>{const[s,t]=d.useState([]),[a,i]=d.useState(!1),[r,o]=d.useState(""),{service:l,setService:p}=pe(),c=async()=>{const n=await T();t(n)};d.useEffect(()=>{c()},[]);const j=n=>{window.open(`#/editor?id=${n.code}`,`#/editor?id=${n.code}`)},v=async n=>{await J(n.code),await c()},C=()=>{i(!0)},f=n=>{c(),window.open(`#/editor?id=${n}`,`#/editor?id=${n}`)},g=n=>{p(n),c()},R=async()=>{await L(),await c()},S=async()=>{const n=await V(s.map(B=>B.code)),D=I().format("YYYY-MM-DD HH-mm-ss");M(n,`projects-${D}.zip`)},z=async n=>{await q(n),await c()};return e.jsxs("div",{className:x.container,children:[e.jsxs("div",{className:x.titleContainer,children:[e.jsx("div",{className:x.title,children:"项目"}),e.jsxs("div",{children:[e.jsx(h,{type:"link",icon:e.jsx(Z,{style:{fontSize:20,marginRight:8,color:"#fff",verticalAlign:"-0.25rem"}}),onClick:()=>window.open("https://github.com/longriver1012/visual-engine","_blank")}),e.jsx(U,{options:ye,style:{width:"100px",marginRight:8},value:l,onChange:g}),e.jsx(h,{style:{marginRight:8},onClick:R,children:"导入项目"}),e.jsx(h,{style:{marginRight:8},onClick:S,children:"导出项目"}),e.jsx(h,{type:"primary",style:{marginRight:8},onClick:C,children:"新建项目"})]})]}),e.jsx("div",{className:x.body,children:e.jsx("div",{className:x.projects,children:s.map(n=>e.jsx(be,{item:n,actived:r,onClick:()=>o(n.code),onDoubleClick:()=>j(n),onDelete:()=>v(n),onCopy:z},n.code))})}),e.jsx(ve,{visible:a,setVisible:i,onConfirm:f})]})},fe="_title-container_121nn_1",$e="_title_121nn_1",ke="_container_121nn_12",Ne="_body_121nn_18",we="_projects_121nn_38",_={titleContainer:fe,title:$e,container:ke,body:Ne,projects:we},Pe="_project_16x4a_1",Ie="_cover_16x4a_18",Me="_actived_16x4a_28",Re="_name_16x4a_32",y={project:Pe,cover:Ie,actived:Me,name:Re},Se=[{label:"导入",key:"import"}],ze=s=>{const{item:t,actived:a,onClick:i,onImport:r}=s,o=async({key:l})=>{l==="import"&&r()};return e.jsx(P,{menu:{items:Se,onClick:o},trigger:["contextMenu"],children:e.jsxs("div",{className:y.project,onClick:i,onContextMenu:i,children:[e.jsx("div",{className:`${y.cover} ${a===t.name?y.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:y.name,children:t.name})]})})},De=[{name:"基础测试",cover:"/longriver1012/templates/基础测试.png",content:"/longriver1012/templates/基础测试.zip"},{name:"PBR各部分实现",cover:"/longriver1012/templates/PBR各部分实现.png",content:"/longriver1012/templates/PBR各部分实现.zip"},{name:"PBR环境光照实现",cover:"/longriver1012/templates/PBR环境光照实现.png",content:"/longriver1012/templates/PBR环境光照实现.zip"},{name:"环境贴图渲染",cover:"/longriver1012/templates/环境贴图渲染.png",content:"/longriver1012/templates/环境贴图渲染.zip"},{name:"地球",cover:"/longriver1012/templates/地球.png",content:"/longriver1012/templates/地球.zip"},{name:"模型展示",cover:"/longriver1012/templates/模型展示.png",content:"/longriver1012/templates/模型展示.zip"}],Be=s=>{const{onImport:t}=s,[a,i]=d.useState(""),r=async o=>{const p=await(await fetch(o.content)).blob(),c=new File([p],`${o.name}.zip`,{type:"application/zip"});await K(c),t(),w.success(`已导入模板：${o.name}`)};return e.jsxs("div",{className:_.container,children:[e.jsx("div",{className:_.titleContainer,children:e.jsx("div",{className:_.title,children:"模板"})}),e.jsx("div",{className:_.body,children:e.jsx("div",{className:_.projects,children:De.map(o=>e.jsx(ze,{item:o,actived:a,onClick:()=>i(o.name),onImport:()=>r(o)},o.name))})})]})},Ee=()=>{const[s,t]=d.useState("projects");return e.jsxs("div",{className:N.container,children:[e.jsx(ae,{onClick:t}),e.jsxs("div",{className:N.right,children:[s==="projects"&&e.jsx(Ce,{}),s==="templates"&&e.jsx(Be,{onImport:()=>t("projects")})]})]})};export{Ee as default};
