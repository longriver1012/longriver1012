import{d,I as Y,n as A,al as e,aE as E,aF as F,aG as G,aH as $,aI as H,am as w,an as P,aJ as O,aK as I,aL as M,aA as u,aM as T,aN as L,aO as V,aP as q,aQ as J,aR as K}from"./index-De1Dcx5q.js";import{F as g,M as Q,I as k,S as U}from"./index-DjxMdaTN.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"},X=function(t,a){return d.createElement(Y,A({},t,{ref:a,icon:W}))},Z=d.forwardRef(X);const ee="_container_n78rt_1",te="_right_n78rt_8",N={container:ee,right:te},se="_container_1ag6p_1",ne="_logo_1ag6p_5",oe="_item_1ag6p_9",ce="_label_1ag6p_22",m={container:se,logo:ne,item:oe,label:ce},ae=n=>{const{onClick:t}=n;return e.jsxs("div",{className:m.container,children:[e.jsx("div",{className:m.logo,children:e.jsx("img",{src:E,style:{width:"70%",marginTop:"-5px"}})}),e.jsxs("div",{className:m.item,onClick:()=>t("projects"),children:[e.jsx("span",{className:"iconfont icon-project"}),e.jsx("span",{className:m.label,children:"项目"})]}),e.jsxs("div",{className:m.item,onClick:()=>t("templates"),children:[e.jsx("span",{className:"iconfont icon-template"}),e.jsx("span",{className:m.label,children:"示例"})]}),e.jsxs("div",{className:m.item,onClick:()=>t("documents"),children:[e.jsx("span",{className:"iconfont icon-doc"}),e.jsx("span",{className:m.label,children:"文档"})]})]})},ie="_title-container_121nn_1",le="_title_121nn_1",re="_container_121nn_12",de="_body_121nn_18",me="_projects_121nn_38",v={titleContainer:ie,title:le,container:re,body:de,projects:me},pe=F()(G(n=>({setService:t=>{$.set("service",t),n({service:t})},service:$.get("service")||"local"}))),je={labelCol:{xs:{span:8},sm:{span:4}},wrapperCol:{xs:{span:16},sm:{span:20}}},xe=n=>{const{visible:t,setVisible:a,onConfirm:i}=n,[l]=g.useForm(),[o,r]=d.useState(!1),p=()=>{l.submit()},c=()=>{a(!1)},j=async x=>{r(!0);const{name:C,desc:f}=x,h=await H(C,f);h===-1?w.error("项目名称已存在，请更换名称"):(a(!1),i(h)),r(!1)};return e.jsx(Q,{title:"创建3D项目",open:t,loading:o,onOk:p,onCancel:c,children:e.jsxs(g,{form:l,...je,onFinish:j,children:[e.jsx(g.Item,{label:"项目名称",name:"name",rules:[{required:!0,message:"请输入项目名称"}],children:e.jsx(k,{})}),e.jsx(g.Item,{label:"项目描述",name:"desc",children:e.jsx(k.TextArea,{})})]})})},ve="_project_16x4a_1",_e="_cover_16x4a_18",he="_actived_16x4a_28",ue="_name_16x4a_32",b={project:ve,cover:_e,actived:he,name:ue},ge=[{label:"复制",key:"copy"},{label:"导出",key:"export"},{label:"删除",key:"delete"}],be=n=>{const{item:t,actived:a,onClick:i,onDoubleClick:l,onDelete:o,onCopy:r}=n,p=async({key:c})=>{if(c==="delete")o();else if(c==="export"){const j=await O(t.code),x=I().format("YYYY-MM-DD HH-mm-ss");M(j,`projects-${x}.zip`)}else c==="copy"&&r(t.code)};return e.jsx(P,{menu:{items:ge,onClick:p},trigger:["contextMenu"],children:e.jsxs("div",{className:b.project,onClick:i,onContextMenu:i,onDoubleClick:l,children:[e.jsx("div",{className:`${b.cover} ${a===t.code?b.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:b.name,children:t.name})]})})},ye=[{label:"本地服务",value:"local"},{label:"远端服务",value:"remote"}],Ce=()=>{const[n,t]=d.useState([]),[a,i]=d.useState(!1),[l,o]=d.useState(""),{service:r,setService:p}=pe(),c=async()=>{const s=await T();t(s)};d.useEffect(()=>{c()},[]);const j=s=>{window.open(`#/editor?id=${s.code}`,`#/editor?id=${s.code}`)},x=async s=>{await J(s.code),await c()},C=()=>{i(!0)},f=s=>{c(),window.open(`#/editor?id=${s}`,`#/editor?id=${s}`)},h=s=>{p(s),c()},R=async()=>{await L(),await c()},S=async()=>{const s=await V(n.map(B=>B.code)),D=I().format("YYYY-MM-DD HH-mm-ss");M(s,`projects-${D}.zip`)},z=async s=>{await q(s),await c()};return e.jsxs("div",{className:v.container,children:[e.jsxs("div",{className:v.titleContainer,children:[e.jsx("div",{className:v.title,children:"项目"}),e.jsxs("div",{children:[e.jsx(u,{type:"link",icon:e.jsx(Z,{style:{fontSize:20,marginRight:8,color:"#fff",verticalAlign:"-0.25rem"}}),onClick:()=>window.open("https://github.com/longriver1012/visual-engine","_blank")}),e.jsx(U,{options:ye,style:{width:"100px",marginRight:8},value:r,onChange:h}),e.jsx(u,{style:{marginRight:8},onClick:R,children:"导入项目"}),e.jsx(u,{style:{marginRight:8},onClick:S,children:"导出项目"}),e.jsx(u,{type:"primary",style:{marginRight:8},onClick:C,children:"新建项目"})]})]}),e.jsx("div",{className:v.body,children:e.jsx("div",{className:v.projects,children:n.map(s=>e.jsx(be,{item:s,actived:l,onClick:()=>o(s.code),onDoubleClick:()=>j(s),onDelete:()=>x(s),onCopy:z},s.code))})}),e.jsx(xe,{visible:a,setVisible:i,onConfirm:f})]})},fe="_title-container_121nn_1",$e="_title_121nn_1",ke="_container_121nn_12",Ne="_body_121nn_18",we="_projects_121nn_38",_={titleContainer:fe,title:$e,container:ke,body:Ne,projects:we},Pe="_project_16x4a_1",Ie="_cover_16x4a_18",Me="_actived_16x4a_28",Re="_name_16x4a_32",y={project:Pe,cover:Ie,actived:Me,name:Re},Se=[{label:"导入",key:"import"}],ze=n=>{const{item:t,actived:a,onClick:i,onImport:l}=n,o=async({key:r})=>{r==="import"&&l()};return e.jsx(P,{menu:{items:Se,onClick:o},trigger:["contextMenu"],children:e.jsxs("div",{className:y.project,onClick:i,onContextMenu:i,children:[e.jsx("div",{className:`${y.cover} ${a===t.name?y.actived:""}`,style:{backgroundImage:`url(${t.cover})`}}),e.jsx("div",{className:y.name,children:t.name})]})})},De=[{name:"基础测试",cover:"/templates/基础测试.png",content:"/templates/基础测试.zip"},{name:"PBR各部分实现",cover:"/templates/PBR各部分实现.png",content:"/templates/PBR各部分实现.zip"},{name:"PBR环境光照实现",cover:"/templates/PBR环境光照实现.png",content:"/templates/PBR环境光照实现.zip"},{name:"环境贴图渲染",cover:"/templates/环境贴图渲染.png",content:"/templates/环境贴图渲染.zip"},{name:"地球",cover:"/templates/地球.png",content:"/templates/地球.zip"},{name:"模型展示",cover:"/templates/模型展示.png",content:"/templates/模型展示.zip"}],Be=n=>{const{onImport:t}=n,[a,i]=d.useState(""),l=async o=>{const p=await(await fetch(o.content)).blob(),c=new File([p],`${o.name}.zip`,{type:"application/zip"});await K(c),t(),w.success(`已导入模板：${o.name}`)};return e.jsxs("div",{className:_.container,children:[e.jsx("div",{className:_.titleContainer,children:e.jsx("div",{className:_.title,children:"模板"})}),e.jsx("div",{className:_.body,children:e.jsx("div",{className:_.projects,children:De.map(o=>e.jsx(ze,{item:o,actived:a,onClick:()=>i(o.name),onImport:()=>l(o)},o.name))})})]})},Ee=()=>{const[n,t]=d.useState("projects");return e.jsxs("div",{className:N.container,children:[e.jsx(ae,{onClick:t}),e.jsxs("div",{className:N.right,children:[n==="projects"&&e.jsx(Ce,{}),n==="templates"&&e.jsx(Be,{onImport:()=>t("projects")})]})]})};export{Ee as default};
